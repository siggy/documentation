<!DOCTYPE html>
<html lang="en-us">

<head>
  

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>

<link rel="shortcut icon" type="image/png" href="/favicon.ico"/>


<link rel='stylesheet' href='https://documentation.sig.gy/style.min.cecbfb877aac6e34ddc570567aec4b24462631741adce40ae5ab27c8087c8318.css'>


<script src='https://documentation.sig.gy/main.min.0b774fda2366fc06803dd619b7467da11181c73a4ef394b7610a2eb2a3cb7b5d.js' async></script>


  <title>使用管理命令行 - Mastodon documentation</title>

  <meta property="og:type" content="article">
  <meta property="og:url" content="https://documentation.sig.gy/zh-cn/admin/tootctl/">

  
    <meta name="description" content="可以从命令行运行tootctl命令">
    <meta property="og:description" content="可以从命令行运行tootctl命令">
    <meta name="twitter:description" content="可以从命令行运行tootctl命令">
  

  <meta name="twitter:title" content="使用管理命令行">
  <meta name="twitter:site" content="@joinmastodon">

  <link rel="canonical" href="https://documentation.sig.gy/zh-cn/admin/tootctl/">
</head>

<body>
  <div class="container sidebar-layout">
    <nav class="sidebar"><a class="brand" href="/">
  <img class="link-logo" src="/brand.svg" alt="Mastodon" />
</a>

<ul>
  
  
    <li>
      
        <a href="/zh-cn/" class="">什么是Mastodon？</a>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">使用Mastodon</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/zh-cn/user/signup/" class="">创建一个帐户</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/profile/" class="">设置个人资料</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/posting/" class="">发布嘟文</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/network/" class="">使用社交功能</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/moderating/" class="">处理不想要的内容</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/discoverability/" class="">推广自己和他人</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/preferences/" class="">设置你的首选项</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/contacts/" class="">更多设置</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/external/" class="">站外使用Mastodon</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/moving/" class="">迁移或删除帐户</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/user/run-your-own/" class="">运行自己的服务器</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">运营Mastodon</span>
      

      
        <ul class="sub-menu">
          
            <li>
              <a href="/zh-cn/admin/prerequisites/" class="">准备你的机器</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/install/" class="">从源中安装</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/config/" class="">设置你的环境</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/optional/" class="">安装可选特色功能</a>

              
                <ul class="sub-menu">
                  
                    <li>
                      <a href="/zh-cn/admin/optional/elasticsearch/" class="">全文搜索</a>
                    </li>
                  
                    <li>
                      <a href="/zh-cn/admin/optional/tor/" class="">匿名服务</a>
                    </li>
                  
                    <li>
                      <a href="/zh-cn/admin/optional/sso/" class="">单点登录（SSO）</a>
                    </li>
                  
                </ul>
              
            </li>
          
            <li>
              <a href="/zh-cn/admin/setup/" class="">配置你的新实例</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/tootctl/" class="active">使用管理命令行</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/upgrading/" class="">升级到新版本</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/backups/" class="">备份你的服务器</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/migrating/" class="">迁移到新机器</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/scaling/" class="">伸缩你的服务器</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/moderation/" class="">运营操作</a>

              
            </li>
          
            <li>
              <a href="/zh-cn/admin/troubleshooting/" class="">故障分析</a>

              
            </li>
          
        </ul>
      
    </li>
  
    <li>
      
        <span class="sub-title">开发Mastodon应用</span>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">向Mastodon项目做贡献</span>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">遵循的标准</span>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">REST API</span>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">API 方法</span>
      

      
    </li>
  
    <li>
      
        <span class="sub-title">API 实体</span>
      

      
    </li>
  
</ul>
</nav>
    <main>
  <h1>使用管理命令行</h1>

  
    <p>可以从命令行运行tootctl命令</p>
  
  <aside>
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#基础命令">基础命令</a></li>
        <li><a href="#accounts">帐户相关命令</a></li>
        <li><a href="#cache">缓存相关命令</a></li>
        <li><a href="#domains">域名相关命令</a></li>
        <li><a href="#emoji">Emoji相关命令</a></li>
        <li><a href="#feeds">时间流（Feeds）相关命令</a></li>
        <li><a href="#media">媒体相关命令</a></li>
        <li><a href="#preview_cards">预览卡片（Preview Cards）相关命令</a></li>
        <li><a href="#search">搜索相关命令</a></li>
        <li><a href="#settings">站点设定相关命令</a></li>
        <li><a href="#statuses">嘟文相关命令</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>
  <div class="e-content">
    <hr>
<p>Mastodon的命令行界面是一个位于Mastodon根目录内<code>bin</code>目录中的名为<code>tootctl</code>的可执行文件。你必须通过<code>RAILS_ENV</code>环境变量指定你执行时打算使用的环境。除非你是在本地计算机上进行开发工作，否则你需要使用<code>RAILS_ENV=production</code>。如果你确信永不使用其它环境（开发、测试），为了方便起见，你可以把它添加到 <code>.bashrc</code> 文件，例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;export RAILS_ENV=production&#34;</span> &gt;&gt; ~/.bashrc
</span></span></code></pre></div><p>如果这样，便无需在每次执行时指定它。否则，通常会这样调用 <code>tootctl</code> 命令（假定你的Mastodon代码位于<code>/home/mastodon/live</code>）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> /home/mastodon/live
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">RAILS_ENV</span><span style="color:#ff79c6">=</span>production bin/tootctl <span style="color:#8be9fd;font-style:italic">help</span>
</span></span></code></pre></div><h2 id="基础命令">基础命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/cli.rb
</a>

<h3 id="self-destruct"><code>tootctl self-destruct</code></h3>
<p>通过向所有己知实例广播帐户删除通告，将本服务器从联邦宇宙抹除。此命令允许Mastodon服务器“干净退出（clean exit）”，即几乎不在其它服务器留下任何缓存。此命令始终是交互式的，且需要二次确认。</p>
<p>实际上，不会删除任何本地数据，因为直接清空数据库或删除整个VPS更快。如果你运行此命令后，无论如何都要继续运营实例，状态不匹配可能导致与其它站点互联时出错。</p>
<div class="hint hint-danger">
  <div class="hint-icon"><i class="fa fa-exclamation-triangle"></i></div>

  <strong>运行此命令之前，请确保你确实知道自己正在做什么。<strong>此操作</strong>不</strong>可逆，并且可能花费很长时间。完成此命令之后，服务器将处于<strong>破碎状态</strong>（BROKEN STATE）。需要一个运行中的Sidekiq进程，所以在队列完全被清空之前不要关闭服务器。
</div>

<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="version"><code>tootctl --version</code></h3>
<p>展示目前运行的Mastodon实例版本。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.7.0 - 被加入</li>
</ul>
<h2 id="accounts">帐户相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/accounts_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/accounts_cli.rb
</a>

<h3 id="accounts-rotate"><code>tootctl accounts rotate</code></h3>
<p>生成并广播新的RSA密钥，作为安全维护的一部分。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.5.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地帐户用户名</td>
</tr>
<tr>
<td style="text-align:left"><code>--all</code></td>
<td style="text-align:left">轮替所有本地帐户密钥，可取代 USERNAME。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-create"><code>tootctl accounts create</code></h3>
<p>创建一个给定用户名（USERNAME）和给定电子邮件地址（&ndash;email）的新帐户。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">新帐户的本地用户名。 必须的。</td>
</tr>
<tr>
<td style="text-align:left"><code>--email EMAIL</code></td>
<td style="text-align:left">要附加到用户的电子邮件地址。 必须的。</td>
</tr>
<tr>
<td style="text-align:left"><code>--confirmed</code></td>
<td style="text-align:left">跳过发送确认邮件步骤并立即激活帐户。</td>
</tr>
<tr>
<td style="text-align:left"><code>--role ROLE</code></td>
<td style="text-align:left">设定新用户的身份为 <code>user</code>, <code>moderator</code> 或 <code>admin</code>。默认为 <code>user</code>。</td>
</tr>
<tr>
<td style="text-align:left"><code>--reattach</code></td>
<td style="text-align:left">重用已被删除帐户的旧用户名。</td>
</tr>
<tr>
<td style="text-align:left"><code>--force</code></td>
<td style="text-align:left">强制删除使用此用户名（USERNAME）的现有帐户，然后重新的新帐户代替（刚刚删除的）该帐户。</td>
</tr>
<tr>
<td style="text-align:left"><code>--skip-sign-in-token</code></td>
<td style="text-align:left">强制跳过该用户登录时的邮件验证码（目前这是不可逆操作）。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-modify"><code>tootctl accounts modify</code></h3>
<p>修改某帐户的身份，电子邮箱地址，激活状态，审核状态及禁用双因素认证（2FA）。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地帐户的用户名。 必须的。</td>
</tr>
<tr>
<td style="text-align:left"><code>--role ROLE</code></td>
<td style="text-align:left">设定该帐户的身份为 <code>user</code>, <code>moderator</code> 或 <code>admin</code>。</td>
</tr>
<tr>
<td style="text-align:left"><code>--email EMAIL</code></td>
<td style="text-align:left">将该帐户电子邮箱地址改为 EMAIL。</td>
</tr>
<tr>
<td style="text-align:left"><code>--confirm</code></td>
<td style="text-align:left">跳过邮件确认步骤，当使用 &ndash;email 时可用。</td>
</tr>
<tr>
<td style="text-align:left"><code>--disable</code></td>
<td style="text-align:left">禁止 USERNAME 帐户登录。</td>
</tr>
<tr>
<td style="text-align:left"><code>--enable</code></td>
<td style="text-align:left">允许 USERNAME 帐户登录，如果该帐户目前被禁止登录。</td>
</tr>
<tr>
<td style="text-align:left"><code>--approve</code></td>
<td style="text-align:left">审核通过该帐户，如果你的实例为审核制。</td>
</tr>
<tr>
<td style="text-align:left"><code>--disable_2fa</code></td>
<td style="text-align:left">移除额外认证因素，允许只用密码登录。</td>
</tr>
<tr>
<td style="text-align:left"><code>--reset-password</code></td>
<td style="text-align:left">重置此用户的密码，将用一个随机生成的字符串作为临时密码。</td>
</tr>
<tr>
<td style="text-align:left"><code>--skip-sign-in-token</code></td>
<td style="text-align:left">强制跳过该用户登录时的邮件验证码（目前这是不可逆操作）。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-delete"><code>tootctl accounts delete</code></h3>
<p>删除给定 USERNAME 的用户帐户。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地帐户的用户名。 必须的。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-backup"><code>tootctl accounts backup</code></h3>
<p>请求给定 USERNAME 帐户的备份。备份将会被 Sidekiq 异步创建，创建完成后用户将接收到一封带有备份链接的电子邮件。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地帐户的用户名。 必须的。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-cull"><code>tootctl accounts cull</code></h3>
<p>移除不在存在的远程帐户。查询数据库中的所有远程帐户，以确认其是否仍存在于原有服务器，如果不存在，那么该帐户将从数据库中删除。在远程服务器刚刚下线的情况下，最近一周有活动痕迹的帐户将被排除在检测范围之外。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
<li>2.8.0 - 加入 <code>--dry_run</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-refresh"><code>tootctl accounts refresh</code></h3>
<p>重新拉取一个或多个远程帐户的数据与文件。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">远程用户名</td>
</tr>
<tr>
<td style="text-align:left"><code>--all</code></td>
<td style="text-align:left">刷新所有远程帐户，可取代 USERNAME。</td>
</tr>
<tr>
<td style="text-align:left"><code>--domain DOMAIN</code></td>
<td style="text-align:left">仅操作此域名 DOMAIN 下的远程帐户。可取代 USERNAME。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-follow"><code>tootctl accounts follow</code></h3>
<p>迫使所有本地帐户关注给定本地帐户。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.7.0 - 被加入</li>
<li>3.0.0 - 使用 USERNAME 取代 ACCT</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地用户名</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-unfollow"><code>tootctl accounts unfollow</code></h3>
<p>迫使所有本地帐户取消关注给定帐户。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.7.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>ACCT</code></td>
<td style="text-align:left"><code>username@domain</code> 地址</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-reset-relationships"><code>tootctl accounts reset-relationships</code></h3>
<p>重置某本地帐户所有正在关注和/或关注者。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">本地用户名</td>
</tr>
<tr>
<td style="text-align:left"><code>--follows</code></td>
<td style="text-align:left">迫使 USERNAME 取消关注所有人后，再重新关注他们。</td>
</tr>
<tr>
<td style="text-align:left"><code>--followers</code></td>
<td style="text-align:left">移除 USERNAME 的所有关注者。</td>
</tr>
</tbody>
</table>
<h3 id="accounts-approve"><code>tootctl accounts approve</code></h3>
<p>当实例为审核制时，审核通过新注册者。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">审核通过这个用户名的待审核帐户。</td>
</tr>
<tr>
<td style="text-align:left"><code>--number N</code></td>
<td style="text-align:left">审核通过最近N个注册者。</td>
</tr>
<tr>
<td style="text-align:left"><code>--all</code></td>
<td style="text-align:left">审核通过所有待审核帐户。</td>
</tr>
</tbody>
</table>
<h2 id="cache">缓存相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/cache_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/cache_cli.rb
</a>

<h3 id="cache-clear"><code>tootctl cache clear</code></h3>
<p>清除缓存存储。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.1 - 被加入</li>
</ul>
<h3 id="cache-recount"><code>tootctl cache recount</code></h3>
<p>通过从头开始进行引用计数，更新指定类型的硬缓存计数。此操作可能会花费很长时间才能完成，这取决于你的数据库大小。帐户将刷新正在关注数、关注者数、嘟文数。嘟文将刷新回复数、转发数及喜爱数。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.0.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TYPE</td>
<td style="text-align:left"><code>accounts</code> 或 <code>statuses</code></td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
</tbody>
</table>
<h2 id="domains">域名相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/domains_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/domains_cli.rb
</a>

<h3 id="domains-purge"><code>tootctl domains purge</code></h3>
<p>移除给定域名的所有帐号，不留下任何纪录。与封禁（suspension）不同，如果该域名（DOMAIN）仍存在，这意味着如果该域名上的帐户被再次解析，帐户将重新回来。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
<li>2.8.0 - 加入 <code>--whitelist_mode</code></li>
<li>2.9.0 - 同时移除自定义emoji</li>
<li>3.0.0 - 可同时接受多个域名</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>DOMAIN[...]</code></td>
<td style="text-align:left">要移除的域名（Domains），使用空格进行分隔。</td>
</tr>
<tr>
<td style="text-align:left"><code>--whitelist_mode</code></td>
<td style="text-align:left">可取代 DOMAIN。不是移除单一域名，而是从数据库移除所有来自非白名单站点的帐户。启用白名单模式并完成白名单设定后运行此命令。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认为5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="domains-crawl"><code>tootctl domains crawl</code></h3>
<p>通过使用Mastodon REST API，爬取API暴露的所有节点，收集这些节点的统计数字（只要这些节点支持相关API），来爬取已知联邦宇宙。当没有给定 START 时，此命令将使用服务器数据库中的已知节点作为爬取的种子。返回总实例数、总注册帐户数、最近一周内的总活跃帐户数、最近一周内新加入的总帐户数。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.7.0 - 被加入</li>
<li>3.0.0 - 加入 <code>--exclude_suspended</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">START</td>
<td style="text-align:left">可选的，从一个不同域名开始。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认为50。</td>
</tr>
<tr>
<td style="text-align:left"><code>--format FORMAT</code></td>
<td style="text-align:left">控制数据的返回方式。<code>summary</code>将打印一个总结。<code>domains</code>将返回以换行符分隔的所有已发现节点列表。<code>json</code>将输出原始数据汇总。默认为<code>summary</code>。</td>
</tr>
<tr>
<td style="text-align:left"><code>--exclude_suspended</code></td>
<td style="text-align:left">输出中不包括已被你封禁的域名，子域名也将包括内。</td>
</tr>
</tbody>
</table>
<h2 id="emoji">Emoji相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/emoji_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/emoji_cli.rb
</a>

<h3 id="emoji-import"><code>tootctl emoji import</code></h3>
<p>从一个给定路径的 .tar.gz 存档中导入自定义emoji。存档中包含的PNG、GIF文件不能大于50KB，emoji短代码（shortcode）将被设为去除扩展名后的文件名，可以使用选项附加前缀与后缀。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.5.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>PATH</code></td>
<td style="text-align:left">含图片的 .tar.gz 存档文件的路径。</td>
</tr>
<tr>
<td style="text-align:left"><code>--prefix PREFIX</code></td>
<td style="text-align:left">在生成的短代码开头附加前缀 PREFIX。</td>
</tr>
<tr>
<td style="text-align:left"><code>--suffix SUFFIX</code></td>
<td style="text-align:left">在生成的短代码结尾附加后缀 SUFFIX。</td>
</tr>
<tr>
<td style="text-align:left"><code>--overwrite</code></td>
<td style="text-align:left">不是跳过已存在的emoji，而是覆盖同名短代码的emoji。</td>
</tr>
<tr>
<td style="text-align:left"><code>--unlisted</code></td>
<td style="text-align:left">导入的emojis将不在emoji选择器中出现，但仍能通过它们的短代码来使用。</td>
</tr>
<tr>
<td style="text-align:left"><code>--category CATEGORY</code></td>
<td style="text-align:left">导入的emoji在选择器的将会分组至 CATEGORY。</td>
</tr>
</tbody>
</table>
<h3 id="emoji-purge"><code>tootctl emoji purge</code></h3>
<p>移除所有自定义emoji。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
<li>3.1.0 - 加入 <code>--remote_only</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--remote_only</code></td>
<td style="text-align:left">如果被提供，将仅移除远程实例。</td>
</tr>
</tbody>
</table>
<h2 id="feeds">时间流（Feeds）相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/feeds_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/feeds_cli.rb
</a>

<h3 id="feeds-build"><code>tootctl feeds build</code></h3>
<p>为某个或所有用户构建主页（home）和列表（list）时间流。时间流将从数所库中构建，并使用Redis缓存于内存中。Mastodon 自动管理激活用户的主页时间流。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>USERNAME</code></td>
<td style="text-align:left">要被生成时间流的本地用户名。</td>
</tr>
<tr>
<td style="text-align:left"><code>--all</code></td>
<td style="text-align:left">刷新所有本地用户的时间流，可取代 USERNAME。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认N=5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="feeds-clear"><code>tootctl feeds clear</code></h3>
<p>从Redis中移除所有主页和列表时间流。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<h2 id="media">媒体相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/media_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/media_cli.rb
</a>

<h3 id="media-remove"><code>tootctl media remove</code></h3>
<p>移除本地缓存的其它实例媒体附件。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.5.0 - 被加入</li>
<li>2.6.2 - 显示被释放的硬盘空间</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--days</code></td>
<td style="text-align:left">多久之前的媒体附件将会被清理。默认为7天。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认为5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="media-remove-orphans"><code>tootctl media remove-orphans</code></h3>
<p>扫描出不属于任何媒体附件的文件并移除他们。请注意，某些存储提供商会对列出对象所必需的API收取费用。另外，此操作需要遍历每个文件，因此速度很慢。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.1.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--start_after</code></td>
<td style="text-align:left">循环开始的附件key值。如果之前中断过此操作，请使用此选项。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
</tbody>
</table>
<h3 id="media-refresh"><code>tootctl media refresh</code></h3>
<p>从其它服务器重拉取远程媒体附件。你必须使用 &ndash;status 、 &ndash;account 或 &ndash;domain 来指定媒体附件来源。如果附件已经存在于数据库，除非你使用 &ndash;force，否则将不会被覆写。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.0.0 - 被加入</li>
<li>3.0.1 - 加入 <code>--force</code> 选项，并默认跳过已下载的附件</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--account ACCT</code></td>
<td style="text-align:left">需要被处理的帐号，格式 <code>username@domain</code></td>
</tr>
<tr>
<td style="text-align:left"><code>--domain DOMAIN</code></td>
<td style="text-align:left">FQDN string</td>
</tr>
<tr>
<td style="text-align:left"><code>--status ID</code></td>
<td style="text-align:left">数据库中的嘟文本地数字ID。</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认为5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
<tr>
<td style="text-align:left"><code>--force</code></td>
<td style="text-align:left">强制重下载远程资源并覆写本地附件。</td>
</tr>
</tbody>
</table>
<h3 id="media-usage"><code>tootctl media usage</code></h3>
<p>计算被Mastodon消耗的硬盘空间。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.0.1 - 被加入</li>
</ul>
<h3 id="media-lookup"><code>tootctl media lookup</code></h3>
<p>提示输入媒体URL，然后查询该媒体显示位置。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.1.0 - 被加入</li>
</ul>
<h2 id="preview_cards">预览卡片（Preview Cards）相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/preview_cards_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/preview_cards_cli.rb
</a>

<h3 id="preview_cards-remove"><code>tootctl preview_cards remove</code></h3>
<p>移除本地预览卡片缩略图。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>3.0.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--days</code></td>
<td style="text-align:left">多久之前的媒体附件将会被清理。默认为180天。（注意：不推荐删除14天内的预览卡片，因为同一链接两周之内再次发布将不会重抓取。）</td>
</tr>
<tr>
<td style="text-align:left"><code>--concurrency N</code></td>
<td style="text-align:left">执行该任务的worker数。默认为5。</td>
</tr>
<tr>
<td style="text-align:left"><code>--verbose</code></td>
<td style="text-align:left">任务进行时，打印额外信息。</td>
</tr>
<tr>
<td style="text-align:left"><code>--dry_run</code></td>
<td style="text-align:left">仅打印预期结果，而不执行任何操作。</td>
</tr>
<tr>
<td style="text-align:left"><code>--link</code></td>
<td style="text-align:left">仅删除链接型（link-type）预览卡片。不处理视频与图片卡片。</td>
</tr>
</tbody>
</table>
<h2 id="search">搜索相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/search_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/search_cli.rb
</a>

<h3 id="search-deploy"><code>tootctl search deploy</code></h3>
<p>创建或更新ElasticSearch索引并进行填充。 如果ElasticSearch为空，此命令将创建必要的索引，然后将数据从数据库导入到这些索引中。如果自上次运行以来索引结构已更改，此命令还将升级索引。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
<li>3.0.0 - 加入 <code>--processes</code> 选项来并行化</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--processes N</code></td>
<td style="text-align:left">并行执行命令。默认N=2。可以设为<code>auto</code>来基于可用CPU数获取相应数值。</td>
</tr>
</tbody>
</table>
<h2 id="settings">站点设定相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/settings_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/settings_cli.rb
</a>

<h3 id="settings-registrations-open"><code>tootctl settings registrations open</code></h3>
<p>开放注册。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<h3 id="settings-registrations-close"><code>tootctl settings registrations close</code></h3>
<p>关闭注册。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.6.0 - 被加入</li>
</ul>
<h2 id="statuses">嘟文相关命令</h2>
<a href="https://github.com/tootsuite/mastodon/blob/master/lib/mastodon/statuses_cli.rb" class="page-ref">
  <div class="page-ref-icon"><i class="fa fa-external-link-square-alt"></i></div>
  lib/mastodon/statuses_cli.rb
</a>

<h3 id="statuses-remove"><code>tootctl statuses remove</code></h3>
<p>从数据库中删除未被引用的嘟文，例如来自中继的或来自本地用户不再关注的用户的嘟文，同时没有被回复的或以其他方式与之互动的。</p>
<p>这是一个计算量很大的操作，其会开始之前创建额外的数据库索引，并在结束后删除它们。</p>
<p><strong>版本历史：</strong></p>
<ul>
<li>2.8.0 - 被加入</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>--days</code></td>
<td style="text-align:left">多久之前的嘟文将会被清理。默认为90天。</td>
</tr>
</tbody>
</table>
<figure>
    <p>
        <strong>翻译状态：</strong>
        本文是英文页面 <a href="/admin/tootctl/">Using the admin CLI</a> 的翻译，最后翻译时间：2020-05-05，点击<a href="https://github.com/tootsuite/documentation/compare/ad1ef20f171c9f61439f32168987b0b4f9abd74b...master">这里</a>可以查看翻译后页面的改动。
    </p>
</figure>



    <p style="color: #687590;">
      最后更新于 October 26, 2021 · <a href='https://github.com/tootsuite/documentation/tree/master/content/zh-cn/admin/tootctl.md' style="color: #687590;">改进此页面</a>

      
        <br />

        也可在此找到：

        
          <a href="https://documentation.sig.gy/admin/tootctl/" style="color: #687590;" hreflang="en">English</a>
        
      
    </p>

  </div>
</main>
  </div>

  <footer class="footer container">
  <div class="sponsorship">
    <div class="container">
      <h2>
        Sponsored by
      </h2>

      <div class="logo-grid">
        <div>
          <a href="https://www.dotcom-monitor.com/es/">
            <img src="/assets/sponsors/dotcom-monitor-logo.png" alt="Dotcom-Monitor" />
          </a>

          <a href="https://www.loadview-testing.com/products/jmeter-load-testing/">
            <img src="/assets/sponsors/LoadView-logo.png" alt="LoadView" />
          </a>

          <a href="http://www.stevetures.com/">
            <img src="/assets/sponsors/stephen-tures.jpg" alt="Stephen Tures" />
          </a>

          <a href="https://swayable.com">
            <img src="/assets/sponsors/swayable.jpeg" alt="Swayable" />
          </a>
        </div>
      </div>
    </div>
  </div>

  <p class="legal legal--right">
    <a href='https://joinmastodon.org'>加入Mastodon</a> · <a href='https://blog.joinmastodon.org'>博客</a> · <a href='https://mastodon.social/@Mastodon' target='_blank'><i class='fab fa-mastodon'></i></a> · <a href='https://twitter.com/joinmastodon' rel='nofollow' target='_blank'><i class='fab fa-twitter'></i></a>
  </p>

  <p class="legal"><a href='https://github.com/tootsuite/documentation/tree/master/content/zh-cn/admin/tootctl.md'>查看源代码</a> · <a href='https://creativecommons.org/licenses/by-sa/4.0/'>CC BY-SA 4.0</a> · <a href='https://joinmastodon.org/imprint'>版权信息</a></p>
</footer>

</body>

</html>
